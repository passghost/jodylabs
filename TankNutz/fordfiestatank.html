<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Fiesta-Tank (Top-Down, 48×48, 6f@120ms)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    /* 8-color palette */
    --bg:#101316;         /* page background */
    --tread:#23272b;      /* track rubber */
    --lug:#3a3f2b;        /* tread lugs */
    --paint:#c7493a;      /* Fiesta red */
    --paint-d:#922f29;    /* paint shade */
    --steel:#9aa8b2;      /* metal, turret, barrel */
    --glass:#7ec8c8;      /* windshield */
    --accent:#f2d14a;     /* rim light / hazard */
  }
  html,body{height:100%;}
  body{
    margin:0; display:grid; place-items:center; background:var(--bg); color:#cfd3da;
    font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;
  }
  .wrap{
    display:grid; gap:.75rem; place-items:center;
  }
  canvas{
    /* Render crisp pixels */
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    background: transparent;
    width: 384px;  /* 48 * 8 */
    height: 384px; /* 48 * 8 */
    border-radius: 8px;
  }
  .note{opacity:.7; font-size:.875rem}
</style>
</head>
<body>
  <div class="wrap">
    <canvas id="view" width="384" height="384" aria-label="Top-down Fiesta-Tank sprite"></canvas>
    <div class="note">48×48 base → 8× upscale | 6 frames @ 120ms | pivot centered</div>
  </div>

<script>
(() => {
  // --- Base & scaling ---
  const BASE = 48;          // logical pixel canvas
  const SCALE = 8;          // upscale factor to screen canvas
  const FRAMES = 6;         // 6-frame loop
  const FRAME_MS = 120;     // ~8.33 fps (120ms per frame)

  // Create offscreen low-res canvas (pixel art source)
  const src = document.createElement('canvas');
  src.width = BASE; src.height = BASE;
  const g = src.getContext('2d');

  // Visible (scaled) canvas
  const view = document.getElementById('view');
  const ctx = view.getContext('2d');
  ctx.imageSmoothingEnabled = false;

  // Helpers
  function clear(c2d, w=BASE, h=BASE){ c2d.clearRect(0,0,w,h); }
  const C = getComputedStyle(document.documentElement);
  const COL = {
    tread: C.getPropertyValue('--tread').trim(),
    lug:   C.getPropertyValue('--lug').trim(),
    paint: C.getPropertyValue('--paint').trim(),
    paintD:C.getPropertyValue('--paint-d').trim(),
    steel: C.getPropertyValue('--steel').trim(),
    glass: C.getPropertyValue('--glass').trim(),
    accent:C.getPropertyValue('--accent').trim(),
  };
  function rect(x,y,w,h,fill){
    g.fillStyle = fill;
    g.fillRect(Math.round(x), Math.round(y), Math.round(w), Math.round(h));
  }
  function px(x,y,fill){ rect(x,y,1,1,fill); }
  function outlineRect(x,y,w,h,color){
    g.fillStyle = color;
    g.fillRect(x,y,w,1); g.fillRect(x,y+h-1,w,1);
    g.fillRect(x,y,1,h); g.fillRect(x+w-1,y,1,h);
  }

  // Draw tread with animated lugs
  function drawTrack(x, y, w, h, offset){
    // base rubber
    rect(x, y, w, h, COL.tread);
    // inner cavity (subtle inset)
    rect(x+1, y+1, w-2, h-2, COL.tread);

    // moving lugs pattern (every 3px, offset anim)
    const step = 3;
    for(let i = 0; i < h-2; i += step){
      const yy = y + 1 + ((i + offset) % (h-2));
      // two lugs across track width
      rect(x+1, yy, w-2, 1, COL.lug);
      if (w >= 5) {
        px(x+1, yy, COL.lug);
        px(x+w-2, yy, COL.lug);
      }
    }

    // hazard rim-light line on outer edge (accent)
    px(x + (w-1), y+1, COL.accent);
    for(let i=y+2;i<y+h-1;i+=6) px(x + (w-1), i, COL.accent);
  }

  // Hull (Fiesta-ish hatch fused with tank) + turret/barrel
  function drawHull(frame){
    // subtle bob & sway
    const bob = [0,1,1,0,-1,-1][frame];
    const sway = [0,0,1,0,0,-1][frame];
    g.save();
    g.translate(0, bob);

    // Tracks (left/right)
    drawTrack(6+sway, 6, 6, 36, frame);         // left
    drawTrack(BASE-12-6+sway, 6, 6, 36, (frame*2)%36); // right

    // Lower shadow under hull (paint shade)
    rect(12+sway, 32, 24, 8, COL.paintD);

    // Main hull body (rounded rectangle feel via stepped edges)
    // central block
    rect(12+sway, 10, 24, 24, COL.paint);
    // nose taper (Fiesta-ish teardrop)
    rect(14+sway, 8, 20, 2, COL.paint);
    rect(16+sway, 7, 16, 1, COL.paint);
    // tail chamfer
    rect(14+sway, 34, 20, 2, COL.paintD);

    // belt line darker shade down the middle (car styling)
    rect(12+sway, 22, 24, 2, COL.paintD);

    // windscreen (front glass)
    rect(18+sway, 11, 12, 7, COL.glass);
    // glass highlight sparkle anim
    const hlx = 18+sway + (frame%3);
    px(hlx, 11, '#ffffff');
    px(hlx+1, 12, '#ffffff');

    // side skirts over tracks (steel)
    rect(10+sway, 14, 2, 16, COL.steel);
    rect(BASE-12- (2 - sway), 14, 2, 16, COL.steel);

    // turret base (small central pod)
    g.fillStyle = COL.steel;
    g.beginPath();
    // circle-ish with pixel flavor
    g.rect(22+sway, 21, 4, 6); // core
    g.fill();
    // add little shoulders
    rect(21+sway, 22, 1, 4, COL.steel);
    rect(26+sway-1, 22, 1, 4, COL.steel);

    // barrel (stubby) with tiny recoil jiggle
    const recoil = [0,0,1,1,0,0][frame];
    rect(24+sway - recoil, 17, 2, 5, COL.steel);
    // barrel tip highlight
    px(24+sway - recoil, 17, '#ffffff');

    // headlights (small squares on the nose corners)
    px(16+sway, 9, COL.accent);
    px(31+sway, 9, COL.accent);

    // accent rim-light along top-left hull edge
    px(13+sway, 10, COL.accent);
    for(let i=11;i<16;i++) px(12+sway, i, COL.accent);

    g.restore();
  }

  // Draw one frame into src, then blit scaled to view
  function drawFrame(frame){
    clear(g, BASE, BASE);

    // Optional faint center pivot pixel (commented):
    // px(BASE/2|0, BASE/2|0, '#00ff00');

    // Compose sprite
    drawHull(frame);

    // Blit to screen canvas scaled
    ctx.clearRect(0,0,view.width,view.height);
    ctx.imageSmoothingEnabled = false;
    ctx.drawImage(src, 0, 0, BASE, BASE, 0, 0, BASE*SCALE, BASE*SCALE);
  }

  // Animate
  let f = 0;
  drawFrame(f);
  setInterval(() => {
    f = (f + 1) % FRAMES;
    drawFrame(f);
  }, FRAME_MS);
})();
</script>
</body>
</html>
