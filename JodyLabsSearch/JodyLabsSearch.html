<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JodyLabs Search Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        secondary: '#4F46E5',
                        accent: '#C7D2FE',
                        darkbg: '#1E1E2E',
                        darkcard: '#2A2A3C'
                    },
                    animation: {
                        'gradient': 'gradient 5s ease infinite',
                    },
                    keyframes: {
                        gradient: {
                            '0%, 100%': { backgroundPosition: '0% 50%' },
                            '50%': { backgroundPosition: '100% 50%' },
                        },
                    }
                }
            }
        }
    </script>
    <style>
        .search-gradient {
            background: linear-gradient(90deg, #5D5CDE, #7B68EE, #9370DB, #7B68EE, #5D5CDE);
            background-size: 300% 300%;
            animation: gradient 8s ease infinite;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50% }
            50% { background-position: 100% 50% }
            100% { background-position: 0% 50% }
        }
        
        .search-container {
            box-shadow: 0 4px 20px rgba(93, 92, 222, 0.15);
            transition: all 0.3s ease;
        }
        
        .search-container:focus-within {
            box-shadow: 0 4px 25px rgba(93, 92, 222, 0.3);
            transform: translateY(-2px);
        }
        
        .dark .search-container {
            box-shadow: 0 4px 20px rgba(93, 92, 222, 0.3);
        }

        #search-input {
            caret-color: #5D5CDE;
        }
        
        .engine-icon {
            transition: all 0.2s ease;
        }
        
        .engine-icon:hover {
            transform: scale(1.15);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo-text {
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            background-image: linear-gradient(90deg, #5D5CDE, #9370DB);
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-darkbg min-h-screen font-sans transition-colors duration-300">
    <!-- Theme detection script -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <div class="container mx-auto px-4 py-12 max-w-4xl">
        <!-- Logo and header -->
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold mb-2 logo-text">JodyLabs</h1>
            <p class="text-gray-600 dark:text-gray-300">Your intelligent search companion</p>
        </div>

        <!-- Main search container -->
        <div class="search-container bg-white dark:bg-darkcard rounded-xl p-4 md:p-6 mb-8">
            <form id="search-form" class="flex flex-col">
                <div class="flex items-center mb-4">
                    <span class="text-primary text-xl px-3">
                        <i class="fas fa-search"></i>
                    </span>
                    <input 
                        type="text" 
                        id="search-input"
                        class="w-full text-lg md:text-xl py-2 px-3 bg-transparent outline-none border-none text-gray-800 dark:text-white placeholder-gray-400"
                        placeholder="Search anything..."
                        autocomplete="off"
                        required
                    >
                    <button 
                        type="submit" 
                        class="ml-2 bg-primary hover:bg-secondary text-white rounded-lg px-4 py-2 transition-colors duration-300 flex items-center"
                    >
                        <span class="hidden sm:inline mr-1">Search</span>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

                <!-- Search engine options -->
                <div class="flex flex-wrap gap-3 justify-center pt-2 border-t border-gray-100 dark:border-gray-700">
                    <label class="engine-option">
                        <input type="radio" name="search-engine" value="google" checked class="hidden">
                        <div class="engine-icon cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center">
                            <img src="https://i.imgur.com/Iezf7Mq.png" alt="Google" class="w-5 h-5">
                            <span class="ml-2 text-gray-700 dark:text-gray-300">Google</span>
                        </div>
                    </label>
                    
                    <label class="engine-option">
                        <input type="radio" name="search-engine" value="bing" class="hidden">
                        <div class="engine-icon cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center">
                            <img src="https://i.imgur.com/HbJlbCT.png" alt="Bing" class="w-5 h-5">
                            <span class="ml-2 text-gray-700 dark:text-gray-300">Bing</span>
                        </div>
                    </label>
                    
                    <label class="engine-option">
                        <input type="radio" name="search-engine" value="duckduckgo" class="hidden">
                        <div class="engine-icon cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center">
                            <img src="https://i.imgur.com/vOONBqg.png" alt="DuckDuckGo" class="w-5 h-5">
                            <span class="ml-2 text-gray-700 dark:text-gray-300">DuckDuckGo</span>
                        </div>
                    </label>
                    
                    <label class="engine-option">
                        <input type="radio" name="search-engine" value="youtube" class="hidden">
                        <div class="engine-icon cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center">
                            <img src="https://i.imgur.com/c2eKkSr.png" alt="YouTube" class="w-5 h-5">
                            <span class="ml-2 text-gray-700 dark:text-gray-300">YouTube</span>
                        </div>
                    </label>

                    <label class="engine-option">
                        <input type="radio" name="search-engine" value="scholar" class="hidden">
                        <div class="engine-icon cursor-pointer p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center">
                            <img src="https://i.imgur.com/l3t8HVs.png" alt="Scholar" class="w-5 h-5">
                            <span class="ml-2 text-gray-700 dark:text-gray-300">Scholar</span>
                        </div>
                    </label>
                </div>
            </form>
        </div>

        <!-- Features section -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <div class="bg-white dark:bg-darkcard rounded-xl p-5 shadow-md hover:shadow-lg transition-shadow duration-300">
                <div class="text-primary text-xl mb-3">
                    <i class="fas fa-bolt"></i>
                </div>
                <h3 class="text-lg font-semibold mb-2 text-gray-800 dark:text-white">Fast Search</h3>
                <p class="text-gray-600 dark:text-gray-300">Search across multiple engines with a single click.</p>
            </div>
            
            <div class="bg-white dark:bg-darkcard rounded-xl p-5 shadow-md hover:shadow-lg transition-shadow duration-300">
                <div class="text-primary text-xl mb-3">
                    <i class="fas fa-history"></i>
                </div>
                <h3 class="text-lg font-semibold mb-2 text-gray-800 dark:text-white">Search History</h3>
                <p class="text-gray-600 dark:text-gray-300">Keep track of your recent searches for easy access.</p>
            </div>
            
            <div class="bg-white dark:bg-darkcard rounded-xl p-5 shadow-md hover:shadow-lg transition-shadow duration-300">
                <div class="text-primary text-xl mb-3">
                    <i class="fas fa-moon"></i>
                </div>
                <h3 class="text-lg font-semibold mb-2 text-gray-800 dark:text-white">Dark Mode</h3>
                <p class="text-gray-600 dark:text-gray-300">Comfortable viewing experience day and night.</p>
            </div>
        </div>

        <!-- Search history -->
        <div id="search-history" class="bg-white dark:bg-darkcard rounded-xl p-4 md:p-6 mb-8 hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold text-gray-800 dark:text-white">Recent Searches</h2>
                <button id="clear-history" class="text-sm text-primary hover:text-secondary">Clear All</button>
            </div>
            <ul id="history-list" class="divide-y divide-gray-100 dark:divide-gray-700">
                <!-- History items will be added here dynamically -->
            </ul>
        </div>

        <!-- Footer -->
        <footer class="text-center text-gray-500 dark:text-gray-400 text-sm mt-12">
            <p class="mb-2">JodyLabs Search Engine Â© 2023</p>
            <div class="flex justify-center gap-4">
                <a href="#" class="hover:text-primary transition-colors">Privacy</a>
                <a href="#" class="hover:text-primary transition-colors">Terms</a>
                <a href="#" class="hover:text-primary transition-colors">About</a>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchForm = document.getElementById('search-form');
            const searchInput = document.getElementById('search-input');
            const searchHistory = document.getElementById('search-history');
            const historyList = document.getElementById('history-list');
            const clearHistoryBtn = document.getElementById('clear-history');
            
            // Store search history in memory (can't use sessionStorage in sandboxed iframe)
            let searches = [];
            updateHistoryUI();
            
            // Handle search form submission
            searchForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // Get the search query
                const query = searchInput.value.trim();
                if (!query) {
                    // Show error if query is empty
                    searchInput.classList.add('border', 'border-red-500');
                    setTimeout(() => {
                        searchInput.classList.remove('border', 'border-red-500');
                    }, 1500);
                    return;
                }
                
                // Get selected search engine
                const selectedRadio = document.querySelector('input[name="search-engine"]:checked');
                const selectedEngine = selectedRadio ? selectedRadio.value : 'google';
                
                console.log(`Search submitted: "${query}" using ${selectedEngine}`);
                
                // Save to history
                saveToHistory(query, selectedEngine);
                
                // Perform search
                performSearch(query, selectedEngine);
                
                // Provide user feedback
                const searchButton = searchForm.querySelector('button[type="submit"]');
                const originalText = searchButton.innerHTML;
                searchButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                setTimeout(() => {
                    searchButton.innerHTML = originalText;
                }, 1000);
            });
            
            // Handle engine selection styling
            const engineOptions = document.querySelectorAll('.engine-option');
            
            // Set initial state for the default selected engine
            document.querySelector('input[name="search-engine"]:checked')
                .closest('.engine-option')
                .querySelector('.engine-icon')
                .classList.add('bg-accent', 'dark:bg-gray-800');
            
            // Add click handlers to each engine option
            engineOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Get the radio input and icon for this option
                    const radio = option.querySelector('input[type="radio"]');
                    const icon = option.querySelector('.engine-icon');
                    
                    // Remove highlighting from all engine icons
                    document.querySelectorAll('.engine-icon').forEach(el => {
                        el.classList.remove('bg-accent', 'dark:bg-gray-800');
                    });
                    
                    // Add highlighting to the clicked engine icon
                    icon.classList.add('bg-accent', 'dark:bg-gray-800');
                    
                    // Select the radio button
                    radio.checked = true;
                    
                    console.log(`Selected search engine: ${radio.value}`);
                });
            });
            
            // Clear history
            clearHistoryBtn.addEventListener('click', () => {
                searches = [];
                updateHistoryUI();
            });
            
            // Perform search based on engine
            function performSearch(query, engine) {
                if (!query) return;
                
                console.log(`Performing search: "${query}" using ${engine}`);
                let searchUrl;
                
                // Verify all search URLs are correct
                switch (engine) {
                    case 'google':
                        searchUrl = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
                        break;
                    case 'bing':
                        searchUrl = `https://www.bing.com/search?q=${encodeURIComponent(query)}`;
                        break;
                    case 'duckduckgo':
                        searchUrl = `https://duckduckgo.com/?q=${encodeURIComponent(query)}`;
                        break;
                    case 'youtube':
                        searchUrl = `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`;
                        break;
                    case 'scholar':
                        searchUrl = `https://scholar.google.com/scholar?q=${encodeURIComponent(query)}`;
                        break;
                    default:
                        searchUrl = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
                }
                
                // Log the final URL for debugging
                console.log("Search URL:", searchUrl);
                
                try {
                    // Open search in a new tab with target="_blank" (required for iframe environment)
                    const newTab = window.open(searchUrl, '_blank');
                    
                    // Check if popup was blocked
                    if (!newTab || newTab.closed || typeof newTab.closed === 'undefined') {
                        console.warn('Popup was blocked. Make sure to allow popups for this site.');
                        
                        // Show a custom popup notification instead of using alert()
                        const notification = document.createElement('div');
                        notification.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                        notification.innerHTML = '<i class="fas fa-exclamation-triangle mr-2"></i> Please allow popups for this site to open search results';
                        document.body.appendChild(notification);
                        
                        setTimeout(() => {
                            notification.classList.add('opacity-0', 'transition-opacity', 'duration-500');
                            setTimeout(() => document.body.removeChild(notification), 500);
                        }, 3000);
                    }
                } catch (error) {
                    console.error('Error opening search URL:', error);
                    
                    // Fallback: create a link and click it
                    const link = document.createElement('a');
                    link.href = searchUrl;
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }
            
            // Save search to history
            function saveToHistory(query, engine) {
                // Check if this search already exists
                const existingIndex = searches.findIndex(s => s.query === query && s.engine === engine);
                
                if (existingIndex !== -1) {
                    // Move to top if exists
                    searches.splice(existingIndex, 1);
                }
                
                // Add to beginning of array
                searches.unshift({
                    query,
                    engine,
                    timestamp: new Date().toISOString()
                });
                
                // Limit to 10 items
                if (searches.length > 10) {
                    searches = searches.slice(0, 10);
                }
                
                // In a real app, we would save to storage, but we can't use sessionStorage in the iframe
                
                // Update UI
                updateHistoryUI();
            }
            
            // Update history UI
            function updateHistoryUI() {
                // Show/hide history section
                if (searches.length > 0) {
                    searchHistory.classList.remove('hidden');
                } else {
                    searchHistory.classList.add('hidden');
                    return;
                }
                
                // Clear current list
                historyList.innerHTML = '';
                
                // Add each search to the list
                searches.forEach((search, index) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'py-2 fade-in';
                    listItem.style.animationDelay = `${index * 0.05}s`;
                    
                    const engineIcons = {
                        'google': 'https://i.imgur.com/Iezf7Mq.png',
                        'bing': 'https://i.imgur.com/HbJlbCT.png',
                        'duckduckgo': 'https://i.imgur.com/vOONBqg.png',
                        'youtube': 'https://i.imgur.com/c2eKkSr.png',
                        'scholar': 'https://i.imgur.com/l3t8HVs.png'
                    };
                    
                    // Format timestamp
                    const date = new Date(search.timestamp);
                    const timeString = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    listItem.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div class="flex items-center cursor-pointer search-item" data-query="${search.query}" data-engine="${search.engine}">
                                <img src="${engineIcons[search.engine]}" alt="${search.engine}" class="w-4 h-4 mr-2">
                                <span class="text-gray-800 dark:text-white">${search.query}</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-xs text-gray-400 mr-3">${timeString}</span>
                                <button class="text-gray-400 hover:text-red-500 delete-search" data-index="${index}">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    
                    historyList.appendChild(listItem);
                });
                
                // Add event listeners for deleting individual searches
                document.querySelectorAll('.delete-search').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.currentTarget.dataset.index);
                        searches.splice(index, 1);
                        updateHistoryUI();
                    });
                });
                
                // Add event listeners for re-running searches
                document.querySelectorAll('.search-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const query = e.currentTarget.dataset.query;
                        const engine = e.currentTarget.dataset.engine;
                        
                        // Fill the search input
                        searchInput.value = query;
                        
                        // Select the correct engine
                        document.querySelector(`input[value="${engine}"]`).checked = true;
                        
                        // Update engine icon styling
                        document.querySelectorAll('.engine-icon').forEach(el => {
                            el.classList.remove('bg-accent', 'dark:bg-gray-800');
                        });
                        document.querySelector(`input[value="${engine}"]`).parentElement.querySelector('.engine-icon').classList.add('bg-accent', 'dark:bg-gray-800');
                        
                        // Perform the search
                        performSearch(query, engine);
                    });
                });
            }
            
            // Focus the search input on page load
            searchInput.focus();
        });
    </script>
</body>
</html>